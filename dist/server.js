"use strict";var d=(u,a)=>()=>(a||u((a={exports:{}}).exports,a),a.exports);var h=d(Ze=>{"use strict";var Hu=Ze&&Ze.__extends||function(){var u=function(a,t){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(i[e]=n[e])},u(a,t)};return function(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");u(a,t);function i(){this.constructor=a}a.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(Ze,"__esModule",{value:!0});var Uu=function(u){Hu(a,u);function a(t){var i=u.call(this)||this;return i.isOperational=!0,i.message=t.message,i.statusCode=t.statusCode,i.errorCode=t.errorCode,i}return a}(Error);Ze.default=Uu});var De=d(fr=>{"use strict";Object.defineProperty(fr,"__esModule",{value:!0});var Pu={DATABASE_HOST:process.env.DATABASE_HOST,DATABASE_PASSWORD:process.env.DATABASE_PASSWORD,DATABASE_NAME:process.env.DATABASE_NAME,DATABASE_USERNAME:process.env.DATABASE_USERNAME,MODE:process.env.MODE,SECRET:process.env.SECRET,EMAIL_RESEND_TOKEN:process.env.EMAIL_RESEND_TOKEN,EMAIL_RESEND:process.env.EMAIL_RESEND,PORT:process.env.PORT,API_PREFIX:process.env.API_PREFIX,IP:process.env.IP};fr.default=Pu});var Dn=d(re=>{"use strict";var Lu=re&&re.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},Gu=re&&re.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},kn=re&&re.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(re,"__esModule",{value:!0});var Wu=kn(h()),Vu=kn(De()),Ju=function(u,a,t,i){return Lu(void 0,void 0,void 0,function(){return Gu(this,function(n){return Array.isArray(u)?(console.log(u),t.status(400).json({message:"the body is not correct",errors:u}),[2]):u instanceof Wu.default?(u.isOperational=void 0,t.status(u.statusCode).json({error:u}),[2]):u instanceof Error?(t.status(400).json({message:u.message,error:Vu.default.MODE==="prod"?void 0:u}),[2]):(t.status(400).json({message:"error"}),[2])})})};re.default=Ju});var y=d(dr=>{"use strict";Object.defineProperty(dr,"__esModule",{value:!0});var xu={USER_EMAIL_NOT_FOUND:{errorCode:"1001",statusCode:404,message:"email not found"},INCORRECT_PASSWORD:{errorCode:"1002",statusCode:400,message:"the provided password is incorrect"},USER_NOT_FOUND:{errorCode:"1003",statusCode:404,message:"user not found"},USER_DOES_NOT_HAVE_ACCESS:{errorCode:"1004",statusCode:401,message:"you can't still login, you need admin permission"},EMAIL_ALREADY_EXISTS:{errorCode:"1004",statusCode:400,message:"the provided email already exists"},USER_NOT_VERIFIED:{errorCode:"1005",statusCode:404,message:"the user is not verified, please send the form to verify"},JWT_NOT_PROVIDED:{errorCode:"2001",statusCode:400,message:"please, login"},UNAUTHORIZED:{errorCode:"2002",statusCode:401,message:"unauthorized access"},JWT_IS_EXPIRED:{errorCode:"2003",statusCode:400,message:"the provided jwt is expired, login again"},FORM_NOT_FOUND:{errorCode:"2004",statusCode:404,message:"the form was not found"},RESULTS_NOT_ENOUGH:{errorCode:"2005",statusCode:400,message:"you need to fill more fields"},RESULTS_ARE_VOID:{errorCode:"2006",statusCode:400,message:"there are still void results, please fill it"},HASH_IS_NOT_VALID:{errorCode:"3001",statusCode:400,message:"the provided hash is not valid"},HASH_NOT_PROVIDED:{errorCode:"3002",statusCode:400,message:"you need a hash"},HASH_IS_EXPIRED:{errorCode:"3003",statusCode:400,message:"the provided hash is expired, please use other"},FORM_SCHEME_NOT_FOUND:{errorCode:"4000",statusCode:404,message:"the form scheme was not found"},FIELD_NOT_FOUND:{errorCode:"5000",statusCode:404,message:"the field was not found"},FORM_GROUP_NOT_FOUND:{errorCode:"6000",statusCode:404,message:"form_group was not found"},FIELD_NOT_BELONG_TO_THE_PROVIDED_FORM:{errorCode:"7000",statusCode:400,message:"the provided field doesn't belong to the provided form, please check if the form_scheme contains the provided field"},FILE_FORMAT_NOT_ALLOWED:{errorCode:"8000",statusCode:400,message:"the format of the provided file is not allowed"},FILE_NOT_FOUND:{errorCode:"8001",statusCode:404,message:"the file was not found"}};dr.default=xu});var b=d(Ke=>{"use strict";var Mn=Ke&&Ke.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(Ke,"__esModule",{value:!0});var Xu=Mn(require("mysql2/promise")),Tt=Mn(De()),zu=Xu.default.createPool({database:Tt.default.DATABASE_NAME,user:Tt.default.DATABASE_USERNAME,host:Tt.default.DATABASE_HOST,password:Tt.default.DATABASE_PASSWORD,waitForConnections:!0,connectionLimit:10});Ke.default=zu});var hr=d(ne=>{"use strict";var Yu=ne&&ne.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},Zu=ne&&ne.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},Ku=ne&&ne.__spreadArray||function(u,a,t){if(t||arguments.length===2)for(var i=0,n=a.length,e;i<n;i++)(e||!(i in a))&&(e||(e=Array.prototype.slice.call(a,0,i)),e[i]=a[i]);return u.concat(e||Array.prototype.slice.call(a))};Object.defineProperty(ne,"__esModule",{value:!0});var Qu=function(u){for(var a=[],t=1;t<arguments.length;t++)a[t-1]=arguments[t];return Yu(void 0,Ku([u],a,!0),void 0,function(i,n,e){var o,s,q,c,r,l,q,f,gt,ar,q,Et,or,qe,Ot,lr,ke,St,sr,cr;return n===void 0&&(n=[]),Zu(this,function(Bc){if(i.length===0)return[2,[]];o={},s={};for(q in i[0])o[q]=new Map;for(c=0,r=i;c<r.length;c++){l=r[c];for(q in l)o[q].set(l[q].id,l[q])}for(f=Array.from(Object.keys(o)),gt=0,ar=f;gt<ar.length;gt++)q=ar[gt],s[q]=Array.from(o[q].values());for(Et=0,or=n;Et<or.length;Et++)for(qe=or[Et],Ot=0,lr=s[qe.foreingTableName];Ot<lr.length;Ot++)for(ke=lr[Ot],ke?.["".concat(qe.nameTable,"s")]||(ke["".concat(qe.nameTable,"s")]=[]),St=0,sr=s[qe.nameTable];St<sr.length;St++)cr=sr[St],ke.id===cr["".concat(qe.foreingTableName,"_id")]&&ke["".concat(qe.nameTable,"s")].push(cr);return[2,s[e.recoverFrom]]})})};ne.default=Qu});var ie=d(Me=>{"use strict";var Qe=Me&&Me.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},$e=Me&&Me.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(Me,"__esModule",{value:!0});var $u=function(){function u(){}return u.prototype.findAll=function(){return Qe(this,void 0,void 0,function(){return $e(this,function(a){throw new Error("method not implemented")})})},u.prototype.findById=function(a,t){return Qe(this,void 0,void 0,function(){return $e(this,function(i){throw new Error("method not implemented")})})},u.prototype.save=function(a){return Qe(this,void 0,void 0,function(){return $e(this,function(t){throw new Error("method not implemented")})})},u.prototype.update=function(a){return Qe(this,void 0,void 0,function(){return $e(this,function(t){throw new Error("method not implemented")})})},u.prototype.deleteById=function(a){return Qe(this,void 0,void 0,function(){return $e(this,function(t){throw new Error("method not implemented")})})},u}();Me.default=$u});var vr=d(g=>{"use strict";var ea=g&&g.__extends||function(){var u=function(a,t){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(i[e]=n[e])},u(a,t)};return function(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");u(a,t);function i(){this.constructor=a}a.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),_r=g&&g.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},yr=g&&g.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},ta=g&&g.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(g,"__esModule",{value:!0});g.UserRepository=void 0;var ra=ta(ie()),na=function(u){ea(a,u);function a(){return u!==null&&u.apply(this,arguments)||this}return a.prototype.findByEmail=function(t){return _r(this,void 0,void 0,function(){return yr(this,function(i){throw new Error("method not implemented")})})},a.prototype.saveAdmin=function(t){return _r(this,void 0,void 0,function(){return yr(this,function(i){throw new Error("method not implemented")})})},a.prototype.toggleAccessUser=function(t,i){return _r(this,void 0,void 0,function(){return yr(this,function(n){throw new Error("method not implemented")})})},a}(ra.default);g.UserRepository=na});var In=d(k=>{"use strict";var ia=k&&k.__extends||function(){var u=function(a,t){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(i[e]=n[e])},u(a,t)};return function(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");u(a,t);function i(){this.constructor=a}a.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Ne=k&&k.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},Ce=k&&k.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},An=k&&k.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(k,"__esModule",{value:!0});var Be=An(b()),ua=An(hr()),aa=vr(),oa=function(u){ia(a,u);function a(){return u!==null&&u.apply(this,arguments)||this}return a.prototype.findAll=function(){return Ne(this,void 0,void 0,function(){var t;return Ce(this,function(i){switch(i.label){case 0:return[4,Be.default.query("SELECT * FROM user")];case 1:return t=i.sent()[0],[2,t]}})})},a.prototype.findById=function(t){return Ne(this,void 0,void 0,function(){var i,n;return Ce(this,function(e){switch(e.label){case 0:return[4,Be.default.query({sql:`
        SELECT user.*, multimedia.* FROM user
          LEFT JOIN multimedia
          ON multimedia.user_id = user.id
          WHERE user.id = ?`,nestTables:!0},[t])];case 1:return i=e.sent()[0],[4,(0,ua.default)(i,[{nameTable:"multimedia",foreingTableName:"user"}],{recoverFrom:"user"})];case 2:return n=e.sent(),[2,n[0]]}})})},a.prototype.save=function(t){return Ne(this,void 0,void 0,function(){var i;return Ce(this,function(n){switch(n.label){case 0:return[4,Be.default.query("INSERT INTO user (email, fullname, password, area, has_access, role) VALUES (?, ?, ?, ?, ?, ?)",[t.email,t.fullname,t.password,t.area,0,t.role])];case 1:return i=n.sent()[0],[2,{id:i.insertId,fullname:t.fullname,email:t.email,password:t.password,area:t.area}]}})})},a.prototype.findByEmail=function(t){return Ne(this,void 0,void 0,function(){var i;return Ce(this,function(n){switch(n.label){case 0:return[4,Be.default.query("SELECT id, email, password, fullname, area, has_access, role FROM user WHERE email = ?",[t])];case 1:return i=n.sent()[0][0],[2,i]}})})},a.prototype.saveAdmin=function(t){return Ne(this,void 0,void 0,function(){var i;return Ce(this,function(n){switch(n.label){case 0:return[4,Be.default.query("INSERT INTO user (email, fullname, password, area, has_access, role, verified) VALUES (?, ?, ?, ?, ?, ?, ?)",[t.email,t.fullname,t.password,t.area,1,t.role,1])];case 1:return i=n.sent()[0],[2,{id:i.insertId,fullname:t.fullname,email:t.email,password:t.password,area:t.area}]}})})},a.prototype.toggleAccessUser=function(t,i){return Ne(this,void 0,void 0,function(){var n;return Ce(this,function(e){switch(e.label){case 0:return[4,Be.default.query("UPDATE user SET has_access = ? WHERE id = ?",[Number(t),i])];case 1:return n=e.sent()[0],[2,{id:n.insertId}]}})})},a}(aa.UserRepository);k.default=oa});var Se=d(D=>{"use strict";var la=D&&D.__extends||function(){var u=function(a,t){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(i[e]=n[e])},u(a,t)};return function(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");u(a,t);function i(){this.constructor=a}a.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),He=D&&D.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},Ue=D&&D.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},br=D&&D.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(D,"__esModule",{value:!0});var wr=br(y()),sa=br(In()),ca=vr(),mr=br(h()),fa=function(u){la(a,u);function a(t){var i=u.call(this)||this;return i.userRepository=t,i}return a.prototype.findAll=function(){return He(this,void 0,void 0,function(){var t;return Ue(this,function(i){switch(i.label){case 0:return[4,this.userRepository.findAll()];case 1:return t=i.sent(),[2,t.map(function(n){return n.password=void 0,n})]}})})},a.prototype.save=function(t){return He(this,void 0,void 0,function(){return Ue(this,function(i){return[2,this.userRepository.save(t).catch(function(n){if(n.code==="ER_DUP_ENTRY")throw new mr.default(wr.default.EMAIL_ALREADY_EXISTS);return n})]})})},a.prototype.saveAdmin=function(t){return He(this,void 0,void 0,function(){return Ue(this,function(i){return[2,this.userRepository.saveAdmin(t)]})})},a.prototype.findByEmail=function(t){return He(this,void 0,void 0,function(){var i;return Ue(this,function(n){switch(n.label){case 0:return[4,this.userRepository.findByEmail(t)];case 1:if(i=n.sent(),!i)throw new mr.default(wr.default.USER_EMAIL_NOT_FOUND);return[2,i]}})})},a.prototype.findById=function(t){return He(this,void 0,void 0,function(){var i;return Ue(this,function(n){switch(n.label){case 0:return[4,this.userRepository.findById(t)];case 1:if(i=n.sent(),!i)throw new mr.default(wr.default.USER_NOT_FOUND);return[2,i]}})})},a.prototype.toggleAccessUser=function(t,i){return He(this,void 0,void 0,function(){return Ue(this,function(n){return[2,this.userRepository.toggleAccessUser(t,i)]})})},a}(ca.UserRepository),da=new fa(new sa.default);D.default=da});var E=d(pr=>{"use strict";Object.defineProperty(pr,"__esModule",{value:!0});var ha=require("express-validator"),_a=function(u){return function(a,t,i){var n=(0,ha.validationResult)(a);if(!n.isEmpty())return i(n.array());u(a,t,i).catch(function(e){i(e)})}};pr.default=_a});var Fn=d(ue=>{"use strict";var Rt=ue&&ue.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},qt=ue&&ue.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},jn=ue&&ue.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(ue,"__esModule",{value:!0});var kt=jn(Se()),Dt=jn(E()),ya=function(){function u(){var a=this;this.findAll=(0,Dt.default)(function(t,i){return Rt(a,void 0,void 0,function(){var n;return qt(this,function(e){switch(e.label){case 0:return[4,kt.default.findAll()];case 1:return n=e.sent(),i.status(200).json({users:n.filter(function(o){return o.has_access})}),[2]}})})}),this.findAllNotifications=(0,Dt.default)(function(t,i){return Rt(a,void 0,void 0,function(){var n;return qt(this,function(e){switch(e.label){case 0:return[4,kt.default.findAll()];case 1:return n=e.sent(),i.status(200).json({users:n.filter(function(o){return!o.has_access})}),[2]}})})}),this.save=(0,Dt.default)(function(t,i){return Rt(a,void 0,void 0,function(){var n;return qt(this,function(e){switch(e.label){case 0:return[4,kt.default.save(t.body)];case 1:return n=e.sent(),i.status(200).json({message:"user created successfully",user:n}),[2]}})})}),this.toggleAccessUser=(0,Dt.default)(function(t,i){return Rt(a,void 0,void 0,function(){var n,e,o;return qt(this,function(s){switch(s.label){case 0:return n=t.body,e=n.userId,o=n.access,[4,kt.default.toggleAccessUser(o,e)];case 1:return s.sent(),i.status(200).json({message:"updated user successfully"}),[2]}})})})}return u}(),va=new ya;ue.default=va});var Er=d(gr=>{"use strict";Object.defineProperty(gr,"__esModule",{value:!0});var wa={JWT_AUTH:"ola_auth_jwt"};gr.default=wa});var Tr=d(m=>{"use strict";var Or=m&&m.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},Sr=m&&m.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},Nn=m&&m.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(m,"__esModule",{value:!0});m.verifyTokenUser=m.verifyToken=m.createToken=void 0;var Cn=Nn(require("jsonwebtoken")),Mt=Nn(De());function ma(u){return Or(this,void 0,void 0,function(){return Sr(this,function(a){if(!Mt.default.SECRET)throw new Error("secret not provided");return[2,Cn.default.sign(u,Mt.default.SECRET,{expiresIn:"1d"})]})})}m.createToken=ma;function Bn(u){return Or(this,void 0,void 0,function(){return Sr(this,function(a){if(!Mt.default.SECRET)throw new Error("secret not provided");return[2,Cn.default.verify(u,Mt.default.SECRET)]})})}m.verifyToken=Bn;function ba(u){return Or(this,void 0,void 0,function(){var a;return Sr(this,function(t){switch(t.label){case 0:return[4,Bn(u)];case 1:return a=t.sent(),[2,a]}})})}m.verifyTokenUser=ba});var Pe=d(ae=>{"use strict";var pa=ae&&ae.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},ga=ae&&ae.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},et=ae&&ae.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(ae,"__esModule",{value:!0});var Ea=et(y()),Oa=et(Er()),Sa=et(Se()),Ta=et(E()),Ra=et(h()),qa=Tr(),ka=(0,Ta.default)(function(u,a,t){return pa(void 0,void 0,void 0,function(){var i,n,e;return ga(this,function(o){switch(o.label){case 0:if(i=(e=u.cookies)===null||e===void 0?void 0:e[Oa.default.JWT_AUTH],!i)throw new Ra.default(Ea.default.JWT_NOT_PROVIDED);return[4,(0,qa.verifyTokenUser)(i)];case 1:return n=o.sent(),[4,Sa.default.findById(n.id)];case 2:return o.sent(),u.cookieJwt=i,u.decodedToken=n,t(),[2]}})})});ae.default=ka});var Rr=d(oe=>{"use strict";var Da=oe&&oe.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},Ma=oe&&oe.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},At=oe&&oe.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(oe,"__esModule",{value:!0});var Aa=At(y()),Ia=At(Se()),ja=At(E()),Fa=At(h());function Na(u){var a=this;return(0,ja.default)(function(t,i,n){return Da(a,void 0,void 0,function(){var e,o;return Ma(this,function(s){switch(s.label){case 0:return e=t.decodedToken,[4,Ia.default.findById(e?.id)];case 1:if(o=s.sent(),!u.includes(o?.role))throw new Fa.default(Aa.default.UNAUTHORIZED);return n(),[2]}})})})}oe.default=Na});var Ge=d(Le=>{"use strict";Object.defineProperty(Le,"__esModule",{value:!0});Le.Roles=Le.UserArea=void 0;var Hn;(function(u){u.admin="admin",u.commercial="Asesor comercial",u.design="Dise\xF1o",u.communityManager="Community manager",u.photograph="Fot\xF3grafo",u.telemarketing="Telemarketing",u.secretary="secretar\xEDa"})(Hn||(Le.UserArea=Hn={}));var Un;(function(u){u.admin="admin",u.user="user",u.sales="sales"})(Un||(Le.Roles=Un={}))});var Ln=d(tt=>{"use strict";var qr=tt&&tt.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(tt,"__esModule",{value:!0});var Ca=require("express"),kr=qr(Fn()),Dr=qr(Pe()),Mr=qr(Rr()),Ar=Ge(),Pn=require("express-validator"),It=(0,Ca.Router)();It.route("/").get(Dr.default,(0,Mr.default)([Ar.Roles.admin]),kr.default.findAll);It.route("/notifications").get(Dr.default,(0,Mr.default)([Ar.Roles.admin]),kr.default.findAllNotifications);It.route("/toggle-access").post([(0,Pn.body)("userId").isNumeric(),(0,Pn.body)("access").isBoolean()],Dr.default,(0,Mr.default)([Ar.Roles.admin]),kr.default.toggleAccessUser);tt.default=It});var jr=d(M=>{"use strict";var Gn=M&&M.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},Wn=M&&M.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(M,"__esModule",{value:!0});M.crypPassword=M.comparePassword=void 0;var Ir=require("bcrypt");function Ba(u,a){return Gn(this,void 0,void 0,function(){return Wn(this,function(t){return[2,(0,Ir.compare)(u,a)]})})}M.comparePassword=Ba;function Vn(u){return Gn(this,void 0,void 0,function(){var a;return Wn(this,function(t){switch(t.label){case 0:return[4,(0,Ir.genSalt)()];case 1:return a=t.sent(),[2,(0,Ir.hash)(u,a)]}})})}M.crypPassword=Vn;M.default=Vn});var Fr=d(A=>{"use strict";var Ha=A&&A.__extends||function(){var u=function(a,t){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(i[e]=n[e])},u(a,t)};return function(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");u(a,t);function i(){this.constructor=a}a.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Ua=A&&A.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},Pa=A&&A.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},La=A&&A.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(A,"__esModule",{value:!0});var Ga=La(ie()),Wa=function(u){Ha(a,u);function a(){return u!==null&&u.apply(this,arguments)||this}return a.prototype.find=function(t){return Ua(this,void 0,void 0,function(){return Pa(this,function(i){throw new Error("method not implemented")})})},a}(Ga.default);A.default=Wa});var Yn=d(I=>{"use strict";var Va=I&&I.__extends||function(){var u=function(a,t){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(i[e]=n[e])},u(a,t)};return function(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");u(a,t);function i(){this.constructor=a}a.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Jn=I&&I.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},xn=I&&I.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},zn=I&&I.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(I,"__esModule",{value:!0});var Xn=zn(b()),Ja=zn(Fr()),xa=function(u){Va(a,u);function a(){return u!==null&&u.apply(this,arguments)||this}return a.prototype.save=function(t){return Jn(this,void 0,void 0,function(){var i;return xn(this,function(n){switch(n.label){case 0:return[4,Xn.default.query("INSERT INTO blacklist (token, user_id) VALUES (?, ?)",[t.token,t.user_id])];case 1:return i=n.sent()[0],[2,{id:i.insertId,token:t.token}]}})})},a.prototype.find=function(t){return Jn(this,void 0,void 0,function(){var i;return xn(this,function(n){switch(n.label){case 0:return[4,Xn.default.query("SELECT * FROM blacklist WHERE user_id = ? AND token = ?",[t.user_id,t.token])];case 1:return i=n.sent()[0][0],[2,i]}})})},a}(Ja.default);I.default=xa});var $n=d(j=>{"use strict";var Xa=j&&j.__extends||function(){var u=function(a,t){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(i[e]=n[e])},u(a,t)};return function(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");u(a,t);function i(){this.constructor=a}a.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Zn=j&&j.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},Kn=j&&j.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},Qn=j&&j.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(j,"__esModule",{value:!0});var za=Qn(Fr()),Ya=Qn(Yn()),Za=function(u){Xa(a,u);function a(t){var i=u.call(this)||this;return i.blacklistRespository=t,i}return a.prototype.find=function(t){return Zn(this,void 0,void 0,function(){var i;return Kn(this,function(n){return i=this.blacklistRespository.find(t),[2,i]})})},a.prototype.save=function(t){return Zn(this,void 0,void 0,function(){return Kn(this,function(i){return[2,this.blacklistRespository.save(t)]})})},a}(za.default),Ka=new Za(new Ya.default);j.default=Ka});var Nr=d(O=>{"use strict";var Qa=O&&O.__extends||function(){var u=function(a,t){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(i[e]=n[e])},u(a,t)};return function(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");u(a,t);function i(){this.constructor=a}a.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Ae=O&&O.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},Ie=O&&O.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},$a=O&&O.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(O,"__esModule",{value:!0});O.FormRepository=void 0;var eo=$a(ie()),to=function(u){Qa(a,u);function a(){return u!==null&&u.apply(this,arguments)||this}return a.prototype.addHash=function(t){return Ae(this,void 0,void 0,function(){return Ie(this,function(i){throw new Error("the method is not implemented")})})},a.prototype.findByHash=function(t){return Ae(this,void 0,void 0,function(){return Ie(this,function(i){throw new Error("the method is not implemented")})})},a.prototype.removeHash=function(t){return Ae(this,void 0,void 0,function(){return Ie(this,function(i){throw new Error("the method is not implemented")})})},a.prototype.setExpireTime=function(t){return Ae(this,void 0,void 0,function(){return Ie(this,function(i){throw new Error("the method is not implemented")})})},a.prototype.findAllByUserId=function(t){return Ae(this,void 0,void 0,function(){return Ie(this,function(i){throw new Error("the method is not implemented")})})},a.prototype.findByFormSchemeId=function(t,i){return Ae(this,void 0,void 0,function(){return Ie(this,function(n){throw new Error("the method is not implemented")})})},a.prototype.updateDone=function(t,i,n){return Ae(this,void 0,void 0,function(){return Ie(this,function(e){throw new Error("the method is not implemented")})})},a}(eo.default);O.FormRepository=to});var ei=d(T=>{"use strict";var ro=T&&T.__extends||function(){var u=function(a,t){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(i[e]=n[e])},u(a,t)};return function(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");u(a,t);function i(){this.constructor=a}a.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Q=T&&T.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},$=T&&T.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},no=T&&T.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(T,"__esModule",{value:!0});T.MysqlFormRepository=void 0;var S=no(b()),io=Nr(),uo=function(u){ro(a,u);function a(){return u!==null&&u.apply(this,arguments)||this}return a.prototype.findAll=function(){return Q(this,void 0,void 0,function(){var t;return $(this,function(i){switch(i.label){case 0:return[4,S.default.query({sql:"SELECT * from form"})];case 1:return t=i.sent()[0],[2,t]}})})},a.prototype.save=function(t){return Q(this,void 0,void 0,function(){var i;return $(this,function(n){switch(n.label){case 0:return[4,S.default.query("INSERT INTO form (done, hash, form_scheme_id, user_id) VALUES (?, ?, ?, ?)",[!1,null,t.form_scheme_id,t.user_id])];case 1:return i=n.sent()[0],[2,{id:i.insertId,done:!1,hash:null,form_scheme_id:t.form_scheme_id,user_id:t.user_id}]}})})},a.prototype.addHash=function(t){return Q(this,void 0,void 0,function(){var i;return $(this,function(n){switch(n.label){case 0:return[4,S.default.query("UPDATE form SET hash = ? WHERE id = ?",[t.hash,t.id])];case 1:return i=n.sent()[0],[2,{id:t.id,hash:t.hash}]}})})},a.prototype.findById=function(t,i){return Q(this,void 0,void 0,function(){var n,e;return $(this,function(o){switch(o.label){case 0:return i?[4,S.default.query("SELECT * FROM form WHERE id = ? AND user_id",[t,i.id])]:[3,2];case 1:return n=o.sent()[0][0],[2,n];case 2:return[4,S.default.query("SELECT * FROM form WHERE id = ?",[t])];case 3:return e=o.sent()[0][0],[2,e]}})})},a.prototype.findByHash=function(t){return Q(this,void 0,void 0,function(){var i;return $(this,function(n){switch(n.label){case 0:return[4,S.default.query("SELECT * FROM form WHERE hash = ?",[t])];case 1:return i=n.sent()[0][0],[2,i]}})})},a.prototype.removeHash=function(t){return Q(this,void 0,void 0,function(){var i;return $(this,function(n){switch(n.label){case 0:return[4,S.default.query("UPDATE form SET hash = null WHERE id = ?",[t])];case 1:return i=n.sent()[0],[2,{id:t,hash:null}]}})})},a.prototype.setExpireTime=function(t){return Q(this,void 0,void 0,function(){return $(this,function(i){switch(i.label){case 0:return[4,S.default.query("UPDATE form SET expire_hash_time = ? WHERE id = ? AND user_id = ?",[t.expire_hash_time,t.id,t.user_id])];case 1:return i.sent(),[2,{id:t.id,expire_hash_time:t.expire_hash_time}]}})})},a.prototype.findAllByUserId=function(t){return Q(this,void 0,void 0,function(){var i;return $(this,function(n){switch(n.label){case 0:return[4,S.default.query("SELECT * FROM form WHERE user_id = ?",[t])];case 1:return i=n.sent()[0],[2,i]}})})},a.prototype.findByFormSchemeId=function(t,i){return Q(this,void 0,void 0,function(){var n,e;return $(this,function(o){switch(o.label){case 0:return i?[4,S.default.query("SELECT * FROM form WHERE form_scheme_id = ? AND user_id = ?",[t,i.id])]:[3,2];case 1:return n=o.sent()[0][0],[2,n];case 2:return[4,S.default.query("SELECT * FROM form WHERE form_scheme_id = ?",[t])];case 3:return e=o.sent()[0][0],[2,e]}})})},a.prototype.updateDone=function(t,i,n){return Q(this,void 0,void 0,function(){var e,o,s;return $(this,function(c){switch(c.label){case 0:return e=n?"UPDATE form SET done = ? WHERE id = ? AND user_id = ?":"UPDATE form SET done = ? WHERE id = ? ",o=n?[i,t,n.id]:[t],[4,S.default.query(e,o)];case 1:return s=c.sent()[0],s.affectedRows===0?[2,void 0]:[2,{id:t,done:i,user_id:n?.id}]}})})},a}(io.FormRepository);T.MysqlFormRepository=uo});var Cr=d(Te=>{"use strict";var ti=Te&&Te.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(Te,"__esModule",{value:!0});Te.verifyHmacHash=Te.generateHmacHash=void 0;var ri=ti(require("crypto")),ni=ti(De());function ao(u){var a=ri.default.createHmac("sha1",ni.default.SECRET);return a.write(JSON.stringify(u)),a.end(),a.read().toString("hex")}Te.generateHmacHash=ao;function oo(u,a){var t=ri.default.createHmac("sha1",ni.default.SECRET);t.write(JSON.stringify(u)),t.end();var i=t.read().toString("hex");return i===a}Te.verifyHmacHash=oo});var Br=d(F=>{"use strict";var lo=F&&F.__extends||function(){var u=function(a,t){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(i[e]=n[e])},u(a,t)};return function(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");u(a,t);function i(){this.constructor=a}a.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ii=F&&F.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},ui=F&&F.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},so=F&&F.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(F,"__esModule",{value:!0});var co=so(ie()),fo=function(u){lo(a,u);function a(){return u!==null&&u.apply(this,arguments)||this}return a.prototype.updateResult=function(t){return ii(this,void 0,void 0,function(){return ui(this,function(i){throw new Error("method not defined")})})},a.prototype.findAllBySchemeId=function(t,i){return ii(this,void 0,void 0,function(){return ui(this,function(n){throw new Error("method not defined")})})},a}(co.default);F.default=fo});var oi=d(N=>{"use strict";var ho=N&&N.__extends||function(){var u=function(a,t){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(i[e]=n[e])},u(a,t)};return function(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");u(a,t);function i(){this.constructor=a}a.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Hr=N&&N.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},Ur=N&&N.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},ai=N&&N.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(N,"__esModule",{value:!0});var Pr=ai(b()),_o=ai(Br()),yo=function(u){ho(a,u);function a(){return u!==null&&u.apply(this,arguments)||this}return a.prototype.updateResult=function(t){return Hr(this,void 0,void 0,function(){return Ur(this,function(i){switch(i.label){case 0:return[4,Pr.default.query("UPDATE field SET metadata = ? WHERE id = ?",[t.metadata,t.id])];case 1:return i.sent(),[2,{id:t.id,metadata:t.metadata}]}})})},a.prototype.findById=function(t){return Hr(this,void 0,void 0,function(){var i;return Ur(this,function(n){switch(n.label){case 0:return[4,Pr.default.query("SELECT * FROM field WHERE id = ?",[t])];case 1:return i=n.sent()[0][0],[2,i]}})})},a.prototype.findAllBySchemeId=function(t,i){return Hr(this,void 0,void 0,function(){var n;return Ur(this,function(e){switch(e.label){case 0:return[4,Pr.default.query({sql:`
      SELECT field.* FROM form
      INNER JOIN form_scheme
      ON form_scheme.id = form.form_scheme_id
      INNER JOIN form_group
      ON form_group.form_scheme_id = form_scheme.id
      INNER JOIN field
      ON field.form_group_id = form_group.id
      WHERE form_scheme.id = ?
      `},[t])];case 1:return n=e.sent()[0],[2,n]}})})},a}(_o.default);N.default=yo});var Ft=d(C=>{"use strict";var vo=C&&C.__extends||function(){var u=function(a,t){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(i[e]=n[e])},u(a,t)};return function(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");u(a,t);function i(){this.constructor=a}a.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Lr=C&&C.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},Gr=C&&C.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},jt=C&&C.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(C,"__esModule",{value:!0});var wo=jt(y()),mo=jt(Br()),bo=jt(oi()),po=jt(h()),go=function(u){vo(a,u);function a(t){var i=u.call(this)||this;return i.fieldRespository=t,i}return a.prototype.updateResult=function(t){return Lr(this,void 0,void 0,function(){var i;return Gr(this,function(n){switch(n.label){case 0:return[4,this.fieldRespository.updateResult(t)];case 1:return i=n.sent(),[2,i]}})})},a.prototype.findById=function(t){return Lr(this,void 0,void 0,function(){var i;return Gr(this,function(n){switch(n.label){case 0:return[4,this.fieldRespository.findById(t)];case 1:if(i=n.sent(),!i)throw new po.default(wo.default.FIELD_NOT_FOUND);return[2,i]}})})},a.prototype.findAllBySchemeId=function(t,i){return Lr(this,void 0,void 0,function(){return Gr(this,function(n){return[2,this.fieldRespository.findAllBySchemeId(t,i)]})})},a}(mo.default),Eo=new go(new bo.default);C.default=Eo});var Jr=d(B=>{"use strict";var Oo=B&&B.__extends||function(){var u=function(a,t){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(i[e]=n[e])},u(a,t)};return function(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");u(a,t);function i(){this.constructor=a}a.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Wr=B&&B.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},Vr=B&&B.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},So=B&&B.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(B,"__esModule",{value:!0});var To=So(ie()),Ro=function(u){Oo(a,u);function a(){return u!==null&&u.apply(this,arguments)||this}return a.prototype.findAllUserResults=function(t){return Wr(this,void 0,void 0,function(){return Vr(this,function(i){throw new Error("the method is not implemented")})})},a.prototype.findByFormIdAndFieldId=function(t){return Wr(this,void 0,void 0,function(){return Vr(this,function(i){throw new Error("the method is not implemented")})})},a.prototype.findAllByFormId=function(t){return Wr(this,void 0,void 0,function(){return Vr(this,function(i){throw new Error("the method is not implemented")})})},a}(To.default);B.default=Ro});var si=d(H=>{"use strict";var qo=H&&H.__extends||function(){var u=function(a,t){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(i[e]=n[e])},u(a,t)};return function(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");u(a,t);function i(){this.constructor=a}a.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),rt=H&&H.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},nt=H&&H.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},li=H&&H.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(H,"__esModule",{value:!0});var it=li(b()),ko=li(Jr()),Do=function(u){qo(a,u);function a(){return u!==null&&u.apply(this,arguments)||this}return a.prototype.findAllUserResults=function(t){return rt(this,void 0,void 0,function(){var i;return nt(this,function(n){switch(n.label){case 0:return[4,it.default.query("SELECT * FROM result ",[t.form_id])];case 1:return i=n.sent()[0],[2,i]}})})},a.prototype.save=function(t){return rt(this,void 0,void 0,function(){var i;return nt(this,function(n){switch(n.label){case 0:return[4,it.default.query("INSERT INTO result (form_id, field_id, response) VALUES (?, ?, ?)",[t.form_id,t.field_id,JSON.stringify(t.response)])];case 1:return i=n.sent()[0],[2,{id:i.insertId,form_id:t.form_id,field_id:t.field_id}]}})})},a.prototype.findByFormIdAndFieldId=function(t){return rt(this,void 0,void 0,function(){var i;return nt(this,function(n){switch(n.label){case 0:return[4,it.default.query("SELECT * FROM result WHERE form_id = ? AND field_id = ?",[t.form_id,t.field_id])];case 1:return i=n.sent()[0][0],[2,i]}})})},a.prototype.update=function(t){return rt(this,void 0,void 0,function(){var i;return nt(this,function(n){switch(n.label){case 0:return[4,it.default.query("UPDATE result SET response = ? WHERE form_id = ? AND field_id = ?",[JSON.stringify(t.response),t.form_id,t.field_id])];case 1:return i=n.sent()[0],[2,{id:i.insertId,form_id:t.form_id,field_id:t.field_id}]}})})},a.prototype.findAllByFormId=function(t){return rt(this,void 0,void 0,function(){var i;return nt(this,function(n){switch(n.label){case 0:return[4,it.default.query("SELECT * FROM result WHERE form_id = ?",[t])];case 1:return i=n.sent()[0],[2,i]}})})},a}(ko.default);H.default=Do});var xr=d(je=>{"use strict";var Mo=je&&je.__extends||function(){var u=function(a,t){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(i[e]=n[e])},u(a,t)};return function(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");u(a,t);function i(){this.constructor=a}a.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Ao=je&&je.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(je,"__esModule",{value:!0});var Io=Ao(ie()),jo=function(u){Mo(a,u);function a(){return u!==null&&u.apply(this,arguments)||this}return a}(Io.default);je.default=jo});var fi=d(U=>{"use strict";var Fo=U&&U.__extends||function(){var u=function(a,t){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(i[e]=n[e])},u(a,t)};return function(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");u(a,t);function i(){this.constructor=a}a.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),No=U&&U.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},Co=U&&U.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},ci=U&&U.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(U,"__esModule",{value:!0});var Bo=ci(b()),Ho=ci(xr()),Uo=function(u){Fo(a,u);function a(){return u!==null&&u.apply(this,arguments)||this}return a.prototype.findById=function(t){return No(this,void 0,void 0,function(){var i;return Co(this,function(n){switch(n.label){case 0:return[4,Bo.default.query("SELECT * FROM form_group WHERE id = ?",[t])];case 1:return i=n.sent()[0][0],[2,i]}})})},a}(Ho.default);U.default=Uo});var di=d(P=>{"use strict";var Po=P&&P.__extends||function(){var u=function(a,t){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(i[e]=n[e])},u(a,t)};return function(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");u(a,t);function i(){this.constructor=a}a.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Lo=P&&P.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},Go=P&&P.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},Nt=P&&P.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(P,"__esModule",{value:!0});var Wo=Nt(y()),Vo=Nt(xr()),Jo=Nt(fi()),xo=Nt(h()),Xo=function(u){Po(a,u);function a(t){var i=u.call(this)||this;return i.formGroupRespository=t,i}return a.prototype.findById=function(t){return Lo(this,void 0,void 0,function(){var i;return Go(this,function(n){switch(n.label){case 0:return[4,this.formGroupRespository.findById(t)];case 1:if(i=n.sent(),!i)throw new xo.default(Wo.default.FORM_GROUP_NOT_FOUND);return[2,i]}})})},a}(Vo.default),zo=new Xo(new Jo.default);P.default=zo});var Xr=d(L=>{"use strict";var Yo=L&&L.__extends||function(){var u=function(a,t){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(i[e]=n[e])},u(a,t)};return function(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");u(a,t);function i(){this.constructor=a}a.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Zo=L&&L.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},Ko=L&&L.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},Qo=L&&L.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(L,"__esModule",{value:!0});var $o=Qo(ie()),el=function(u){Yo(a,u);function a(){return u!==null&&u.apply(this,arguments)||this}return a.prototype.findByIdWithResults=function(t,i){return Zo(this,void 0,void 0,function(){return Ko(this,function(n){throw new Error("method not implemented")})})},a}($o.default);L.default=el});var hi=d(G=>{"use strict";var tl=G&&G.__extends||function(){var u=function(a,t){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(i[e]=n[e])},u(a,t)};return function(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");u(a,t);function i(){this.constructor=a}a.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),zr=G&&G.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},Yr=G&&G.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},Qr=G&&G.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(G,"__esModule",{value:!0});var Zr=Qr(b()),rl=Qr(Xr()),Kr=Qr(hr()),nl=function(u){tl(a,u);function a(){return u!==null&&u.apply(this,arguments)||this}return a.prototype.findAll=function(){return zr(this,void 0,void 0,function(){var t,i;return Yr(this,function(n){switch(n.label){case 0:return[4,Zr.default.query({sql:`
      SELECT form_scheme.*, form_group.*, field.* from form_scheme 
        LEFT JOIN form_group 
        ON form_group.form_scheme_id = form_scheme.id
        LEFT JOIN field
        ON field.form_group_id = form_group.id`,nestTables:!0})];case 1:return t=n.sent()[0],[4,(0,Kr.default)(t,[{nameTable:"form_group",foreingTableName:"form_scheme"},{nameTable:"field",foreingTableName:"form_group"}],{recoverFrom:"form_scheme"})];case 2:return i=n.sent(),[2,i]}})})},a.prototype.findById=function(t){return zr(this,void 0,void 0,function(){var i,n;return Yr(this,function(e){switch(e.label){case 0:return[4,Zr.default.query({sql:`
        SELECT form_scheme.*, form_group.*, field.* from form_scheme 
        LEFT JOIN form_group 
        ON form_group.form_scheme_id = form_scheme.id
        LEFT JOIN field
        ON field.form_group_id = form_group.id
        WHERE form_scheme.id = ?`,nestTables:!0},[t])];case 1:return i=e.sent()[0],[4,(0,Kr.default)(i,[{nameTable:"form_group",foreingTableName:"form_scheme"},{nameTable:"field",foreingTableName:"form_group"}],{recoverFrom:"form_scheme"})];case 2:return n=e.sent(),[2,n[0]]}})})},a.prototype.findByIdWithResults=function(t,i){return zr(this,void 0,void 0,function(){var n,e;return Yr(this,function(o){switch(o.label){case 0:return[4,Zr.default.query({sql:`
      SELECT form_scheme.*, form_group.*, field.*, result.* from form_scheme 
        LEFT JOIN form_group 
        ON form_group.form_scheme_id = form_scheme.id
        LEFT JOIN field
        ON field.form_group_id = form_group.id
        LEFT JOIN result
        ON result.field_id = field.id AND result.form_id = ?
        WHERE form_scheme.id = ?`,nestTables:!0},[i,t])];case 1:return n=o.sent()[0],[4,(0,Kr.default)(n,[{nameTable:"form_group",foreingTableName:"form_scheme"},{nameTable:"field",foreingTableName:"form_group"},{nameTable:"result",foreingTableName:"field"}],{recoverFrom:"form_scheme"})];case 2:return e=o.sent(),[2,e[0]]}})})},a}(rl.default);G.default=nl});var Bt=d(W=>{"use strict";var il=W&&W.__extends||function(){var u=function(a,t){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(i[e]=n[e])},u(a,t)};return function(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");u(a,t);function i(){this.constructor=a}a.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),$r=W&&W.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},en=W&&W.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},Ct=W&&W.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(W,"__esModule",{value:!0});var _i=Ct(y()),ul=Ct(Xr()),al=Ct(hi()),yi=Ct(h()),ol=function(u){il(a,u);function a(t){var i=u.call(this)||this;return i.formSchemeRespository=t,i}return a.prototype.findAll=function(){return $r(this,void 0,void 0,function(){return en(this,function(t){return[2,this.formSchemeRespository.findAll()]})})},a.prototype.findById=function(t){return $r(this,void 0,void 0,function(){var i;return en(this,function(n){switch(n.label){case 0:return[4,this.formSchemeRespository.findById(t)];case 1:if(i=n.sent(),!i)throw new yi.default(_i.default.FORM_SCHEME_NOT_FOUND);return[2,i]}})})},a.prototype.findByIdWithResults=function(t,i){return $r(this,void 0,void 0,function(){var n;return en(this,function(e){switch(e.label){case 0:return[4,this.formSchemeRespository.findByIdWithResults(t,i)];case 1:if(n=e.sent(),!n)throw new yi.default(_i.default.FORM_SCHEME_NOT_FOUND);return[2,n]}})})},a}(ul.default),ll=new ol(new al.default);W.default=ll});var tn=d(V=>{"use strict";var sl=V&&V.__extends||function(){var u=function(a,t){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(i[e]=n[e])},u(a,t)};return function(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");u(a,t);function i(){this.constructor=a}a.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ut=V&&V.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},at=V&&V.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},Re=V&&V.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(V,"__esModule",{value:!0});var cl=Re(y()),fl=Re(si()),dl=Re(Jr()),hl=Re(h()),_l=Re(Ft()),yl=Re(di()),vl=Re(Bt()),vi=Re(ot()),wl=function(u){sl(a,u);function a(t){var i=u.call(this)||this;return i.resultRepository=t,i}return a.prototype.findAllUserResults=function(t){return ut(this,void 0,void 0,function(){return at(this,function(i){return[2,this.resultRepository.findAllUserResults(t)]})})},a.prototype.save=function(t){return ut(this,void 0,void 0,function(){return at(this,function(i){return[2,this.resultRepository.save(t)]})})},a.prototype.addResponse=function(t){return ut(this,void 0,void 0,function(){var i,n,e,o,s;return at(this,function(c){switch(c.label){case 0:return[4,vi.default.findById(t.form_id)];case 1:return i=c.sent(),[4,_l.default.findById(t.field_id)];case 2:return n=c.sent(),[4,yl.default.findById(n?.form_group_id)];case 3:return e=c.sent(),[4,vl.default.findById(e.form_scheme_id)];case 4:if(o=c.sent(),o.id!==i.form_scheme_id)throw new hl.default(cl.default.FIELD_NOT_BELONG_TO_THE_PROVIDED_FORM);return[4,this.resultRepository.findByFormIdAndFieldId(t)];case 5:return s=c.sent(),s?[2,this.resultRepository.update(t)]:[2,this.resultRepository.save(t)]}})})},a.prototype.addMultipleResponse=function(t,i,n){return ut(this,void 0,void 0,function(){var e,o,s,c,r,l;return at(this,function(f){switch(f.label){case 0:return e=[],i?[4,vi.default.findByHash(i)]:[3,2];case 1:n=f.sent().id,f.label=2;case 2:o=0,s=t,f.label=3;case 3:return o<s.length?(c=s[o],l=(r=e).push,[4,this.addResponse({field_id:c.field_id,form_id:n,response:c.response})]):[3,6];case 4:l.apply(r,[f.sent()]),f.label=5;case 5:return o++,[3,3];case 6:return[2,e]}})})},a.prototype.findAllByFormId=function(t){return ut(this,void 0,void 0,function(){return at(this,function(i){return[2,this.resultRepository.findAllByFormId(t)]})})},a}(dl.default),ml=new wl(new fl.default);V.default=ml});var ot=d(X=>{"use strict";var bl=X&&X.__extends||function(){var u=function(a,t){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(i[e]=n[e])},u(a,t)};return function(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");u(a,t);function i(){this.constructor=a}a.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),J=X&&X.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},x=X&&X.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},Ht=X&&X.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(X,"__esModule",{value:!0});var pl=Nr(),gl=ei(),We=Ht(h()),Ve=Ht(y()),El=Cr(),Ol=Ht(Ft()),Sl=Ht(tn()),Tl=function(u){bl(a,u);function a(t){var i=u.call(this)||this;return i.formRepository=t,i}return a.prototype.findAll=function(){return J(this,void 0,void 0,function(){return x(this,function(t){return[2,this.formRepository.findAll()]})})},a.prototype.save=function(t){return J(this,void 0,void 0,function(){return x(this,function(i){return[2,this.formRepository.save(t)]})})},a.prototype.findById=function(t,i){return J(this,void 0,void 0,function(){var n;return x(this,function(e){switch(e.label){case 0:return[4,this.formRepository.findById(t,i)];case 1:if(n=e.sent(),!n)throw new We.default(Ve.default.FORM_NOT_FOUND);return[2,n]}})})},a.prototype.addHash=function(t){return J(this,void 0,void 0,function(){var i;return x(this,function(n){switch(n.label){case 0:return[4,this.findById(t.id)];case 1:return n.sent(),i=(0,El.generateHmacHash)({form_id:t.id}),t.hash=i,[2,this.formRepository.addHash(t)]}})})},a.prototype.findByHash=function(t){return J(this,void 0,void 0,function(){var i;return x(this,function(n){switch(n.label){case 0:return[4,this.formRepository.findByHash(t)];case 1:if(i=n.sent(),!i)throw new We.default(Ve.default.FORM_NOT_FOUND);return[2,i]}})})},a.prototype.removeHash=function(t){return J(this,void 0,void 0,function(){return x(this,function(i){return[2,this.formRepository.removeHash(t)]})})},a.prototype.setExpireTime=function(t){return J(this,void 0,void 0,function(){return x(this,function(i){return t.expire_hash_time=new Date(new Date().getTime()+1*6e4),[2,this.formRepository.setExpireTime(t)]})})},a.prototype.findAllByUserId=function(t){return J(this,void 0,void 0,function(){return x(this,function(i){return[2,this.formRepository.findAllByUserId(t)]})})},a.prototype.findByFormSchemeId=function(t,i){return J(this,void 0,void 0,function(){var n;return x(this,function(e){switch(e.label){case 0:return[4,this.formRepository.findByFormSchemeId(t,i)];case 1:if(n=e.sent(),!n)throw new We.default(Ve.default.FORM_NOT_FOUND);return[2,n]}})})},a.prototype.verifyForm=function(t,i){return J(this,void 0,void 0,function(){var n,e,o,s,c,r;return x(this,function(l){switch(l.label){case 0:return[4,this.findById(t,i)];case 1:return n=l.sent(),[4,Ol.default.findAllBySchemeId(n.form_scheme_id)];case 2:return e=l.sent(),[4,Sl.default.findAllByFormId(t)];case 3:if(o=l.sent(),e.length!==o.length)throw new We.default(Ve.default.RESULTS_NOT_ENOUGH);for(s=0,c=o;s<c.length;s++)if(r=c[s],!r.response.value)throw new We.default(Ve.default.RESULTS_ARE_VOID);return[2]}})})},a.prototype.updateDone=function(t,i,n){return J(this,void 0,void 0,function(){var e;return x(this,function(o){switch(o.label){case 0:return[4,this.formRepository.updateDone(t,i,n)];case 1:if(e=o.sent(),!e)throw new We.default(Ve.default.FORM_NOT_FOUND);return[2,e]}})})},a}(pl.FormRepository),Rl=new Tl(new gl.MysqlFormRepository);X.default=Rl});var pi=d(v=>{"use strict";var ql=v&&v.__createBinding||(Object.create?function(u,a,t,i){i===void 0&&(i=t);var n=Object.getOwnPropertyDescriptor(a,t);(!n||("get"in n?!a.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return a[t]}}),Object.defineProperty(u,i,n)}:function(u,a,t,i){i===void 0&&(i=t),u[i]=a[t]}),kl=v&&v.__setModuleDefault||(Object.create?function(u,a){Object.defineProperty(u,"default",{enumerable:!0,value:a})}:function(u,a){u.default=a}),Dl=v&&v.__importStar||function(u){if(u&&u.__esModule)return u;var a={};if(u!=null)for(var t in u)t!=="default"&&Object.prototype.hasOwnProperty.call(u,t)&&ql(a,u,t);return kl(a,u),a},rn=v&&v.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},nn=v&&v.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},lt=v&&v.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(v,"__esModule",{value:!0});var un=lt(y()),Ml=Ge(),wi=Dl(jr()),an=lt(h()),mi=lt($n()),Al=lt(ot()),bi=lt(Se()),Il=function(){function u(){}return u.prototype.signup=function(a){return rn(this,void 0,void 0,function(){var t,i;return nn(this,function(n){switch(n.label){case 0:return t=a,[4,(0,wi.default)(a.password||"")];case 1:return t.password=n.sent(),a.role=Ml.Roles.user,[4,bi.default.save(a)];case 2:return i=n.sent(),[4,Al.default.save({user_id:i.id,form_scheme_id:2})];case 3:return n.sent(),[2,i]}})})},u.prototype.login=function(a){return rn(this,void 0,void 0,function(){var t,i;return nn(this,function(n){switch(n.label){case 0:return[4,bi.default.findByEmail(a.email)];case 1:if(t=n.sent(),!t.has_access)throw new an.default(un.default.USER_DOES_NOT_HAVE_ACCESS);return[4,(0,wi.comparePassword)(a.password,t.password)];case 2:if(i=n.sent(),!i)throw new an.default(un.default.INCORRECT_PASSWORD);return t.password=void 0,[2,t]}})})},u.prototype.logout=function(a){return rn(this,void 0,void 0,function(){var t;return nn(this,function(i){switch(i.label){case 0:return[4,mi.default.find({user_id:a.user_id,token:a.token})];case 1:if(t=i.sent(),t)throw new an.default(un.default.JWT_IS_EXPIRED);return[4,mi.default.save({user_id:a.user_id,token:a.token})];case 2:return i.sent(),[2]}})})},u}(),jl=new Il;v.default=jl});var Ei=d(R=>{"use strict";var Fl=R&&R.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},Nl=R&&R.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},Cl=R&&R.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(R,"__esModule",{value:!0});R.removeTokenCookie=R.createTokenCookie=void 0;var gi=Cl(Er()),Bl=Tr(),on=new Date;on.setDate(on.getDate()+1);var Hl=new Date(0);function Ul(u,a){return Fl(this,void 0,void 0,function(){var t;return Nl(this,function(i){switch(i.label){case 0:return[4,(0,Bl.createToken)(a)];case 1:return t=i.sent(),u.cookie(gi.default.JWT_AUTH,t,{httpOnly:!0,path:"/",expires:on}),[2]}})})}R.createTokenCookie=Ul;function Pl(u){u.cookie(gi.default.JWT_AUTH,"",{httpOnly:!0,path:"/",expires:Hl})}R.removeTokenCookie=Pl});var Si=d(le=>{"use strict";var Ut=le&&le.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},Pt=le&&le.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},st=le&&le.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(le,"__esModule",{value:!0});var Ll=st(y()),ln=st(pi()),Gl=st(Se()),Lt=st(E()),Oi=Ei(),Wl=st(h()),Vl=function(){function u(){var a=this;this.signup=(0,Lt.default)(function(t,i){return Ut(a,void 0,void 0,function(){var n;return Pt(this,function(e){switch(e.label){case 0:return[4,ln.default.signup(t.body)];case 1:return n=e.sent(),n.password=void 0,i.status(200).json({message:"user created successfully",user:n}),[2]}})})}),this.login=(0,Lt.default)(function(t,i){return Ut(a,void 0,void 0,function(){var n;return Pt(this,function(e){switch(e.label){case 0:return[4,ln.default.login(t.body)];case 1:return n=e.sent(),[4,(0,Oi.createTokenCookie)(i,{id:n.id})];case 2:return e.sent(),i.status(200).json({messsage:"user authenticated!",user:n}),[2]}})})}),this.logout=(0,Lt.default)(function(t,i){return Ut(a,void 0,void 0,function(){var n,e;return Pt(this,function(o){switch(o.label){case 0:return n=t.cookieJwt,e=t.decodedToken,[4,ln.default.logout({user_id:e.id,token:n})];case 1:return o.sent(),(0,Oi.removeTokenCookie)(i),i.json({message:"you are logout!"}),[2]}})})}),this.athenticate=(0,Lt.default)(function(t,i){return Ut(a,void 0,void 0,function(){var n,e;return Pt(this,function(o){switch(o.label){case 0:return n=t.decodedToken,[4,Gl.default.findById(n.id)];case 1:if(e=o.sent(),!e.has_access)throw new Wl.default(Ll.default.USER_DOES_NOT_HAVE_ACCESS);return e.password=void 0,i.status(200).json({message:"user authenticated",user:e}),[2]}})})})}return u}(),Jl=new Vl;le.default=Jl});var qi=d(ct=>{"use strict";var Ti=ct&&ct.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(ct,"__esModule",{value:!0});var xl=require("express"),Gt=Ti(Si()),Je=require("express-validator"),Xl=Ge(),Ri=Ti(Pe()),ft=(0,xl.Router)();ft.route("/signup").post([(0,Je.body)("fullname").isString(),(0,Je.body)("email").isEmail(),(0,Je.body)("password").isString(),(0,Je.body)("area").isIn(Object.values(Xl.UserArea))],Gt.default.signup);ft.route("/login").post([(0,Je.body)("email").isEmail(),(0,Je.body)("password").isString()],Gt.default.login);ft.route("/me").get(Ri.default,Gt.default.athenticate);ft.route("/logout").get(Ri.default,Gt.default.logout);ct.default=ft});var Di=d(se=>{"use strict";var sn=se&&se.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},cn=se&&se.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},ki=se&&se.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(se,"__esModule",{value:!0});var fn=ki(tn()),dn=ki(E()),zl=function(){function u(){var a=this;this.findAllResults=(0,dn.default)(function(t,i){return sn(a,void 0,void 0,function(){var n;return cn(this,function(e){switch(e.label){case 0:return[4,fn.default.findAllUserResults(t.body)];case 1:return n=e.sent(),i.status(200).json({results:n}),[2]}})})}),this.addResponse=(0,dn.default)(function(t,i){return sn(a,void 0,void 0,function(){var n;return cn(this,function(e){switch(e.label){case 0:return[4,fn.default.addResponse(t.body)];case 1:return n=e.sent(),i.status(200).json({message:"response added!",result:n}),[2]}})})}),this.addMultipleResponses=(0,dn.default)(function(t,i){return sn(a,void 0,void 0,function(){var n,e,o,s,c;return cn(this,function(r){switch(r.label){case 0:return n=t.body,e=n.results,o=n.hash,s=n.id,[4,fn.default.addMultipleResponse(e,o,s)];case 1:return c=r.sent(),i.status(200).json({message:"form submitted!",results:c}),[2]}})})})}return u}(),Yl=new zl;se.default=Yl});var Mi=d(ce=>{"use strict";var Zl=ce&&ce.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},Kl=ce&&ce.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},Wt=ce&&ce.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(ce,"__esModule",{value:!0});var Ql=Wt(y()),$l=Wt(Se()),es=Wt(E()),ts=Wt(h()),rs=(0,es.default)(function(u,a,t){return Zl(void 0,void 0,void 0,function(){var i,n;return Kl(this,function(e){switch(e.label){case 0:return i=u.decodedToken,[4,$l.default.findById(i?.id)];case 1:if(n=e.sent(),!n.verified)throw new ts.default(Ql.default.USER_NOT_VERIFIED);return t(),[2]}})})});ce.default=rs});var Ai=d(dt=>{"use strict";var hn=dt&&dt.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(dt,"__esModule",{value:!0});var ns=require("express"),_n=hn(Di()),xe=require("express-validator"),is=hn(Mi()),us=hn(Pe()),Vt=(0,ns.Router)();Vt.route("/").get(us.default,is.default,_n.default.findAllResults);Vt.route("/").put([(0,xe.body)("form_id").isNumeric().withMessage("form_id is required"),(0,xe.body)("field_id").isNumeric().withMessage("field_id is required"),(0,xe.body)("response").isObject().withMessage("response is required").custom(function(u){return u.value?1:0}).withMessage("value in response is required")],_n.default.addResponse);Vt.route("/all").put([(0,xe.body)("hash").isString().optional(),(0,xe.body)("id").isNumeric().withMessage("id is required"),(0,xe.body)("results").isArray().withMessage("results is required").custom(function(u){console.log(u);for(var a=0,t=u;a<t.length;a++){var i=t[a];if(!i.field_id&&typeof i.field_id!="string"||!i.response&&typeof i.response!="object"||!i.response.value&&typeof i.response.value!="string")return 0}return 1}).withMessage("the result needs a field_id and a response with a value")],_n.default.addMultipleResponses);dt.default=Vt});var Bi=d(fe=>{"use strict";var Ii=fe&&fe.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},ji=fe&&fe.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},Ci=fe&&fe.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(fe,"__esModule",{value:!0});var Fi=Ci(Bt()),Ni=Ci(E()),as=function(){function u(){var a=this;this.findAll=(0,Ni.default)(function(t,i){return Ii(a,void 0,void 0,function(){var n;return ji(this,function(e){switch(e.label){case 0:return[4,Fi.default.findAll()];case 1:return n=e.sent(),i.status(200).json({form_schemes:n}),[2]}})})}),this.findById=(0,Ni.default)(function(t,i){return Ii(a,void 0,void 0,function(){var n,e;return ji(this,function(o){switch(o.label){case 0:return n=t.params.id,[4,Fi.default.findById(n)];case 1:return e=o.sent(),i.status(200).json({form_scheme:e}),[2]}})})})}return u}(),os=new as;fe.default=os});var Ui=d(ht=>{"use strict";var ls=ht&&ht.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(ht,"__esModule",{value:!0});var ss=require("express"),Hi=ls(Bi()),yn=(0,ss.Router)();yn.route("/").get(Hi.default.findAll);yn.route("/:id").get(Hi.default.findById);ht.default=yn});var Pi=d(vn=>{"use strict";Object.defineProperty(vn,"__esModule",{value:!0});var cs={USER_FORM_ID:2,SALES_FORM_ID:1};vn.default=cs});var Li=d(z=>{"use strict";var Jt=z&&z.__assign||function(){return Jt=Object.assign||function(u){for(var a,t=1,i=arguments.length;t<i;t++){a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(u[n]=a[n])}return u},Jt.apply(this,arguments)},de=z&&z.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},he=z&&z.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},xt=z&&z.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(z,"__esModule",{value:!0});var fs=xt(Pi()),wn=xt(Bt()),ee=xt(ot()),_e=xt(E()),ds=function(){function u(){var a=this;this.findAll=(0,_e.default)(function(t,i){return de(a,void 0,void 0,function(){var n,e;return he(this,function(o){switch(o.label){case 0:return[4,ee.default.findAllByUserId((e=t.decodedToken)===null||e===void 0?void 0:e.id)];case 1:return n=o.sent(),i.status(200).json({forms:n}),[2]}})})}),this.save=(0,_e.default)(function(t,i){return de(a,void 0,void 0,function(){var n,e;return he(this,function(o){switch(o.label){case 0:return[4,ee.default.save(Jt(Jt({},t.body),{user_id:(e=t.decodedToken)===null||e===void 0?void 0:e.id}))];case 1:return n=o.sent(),i.status(200).json({message:"form created successfully",form:n}),[2]}})})}),this.generateLink=(0,_e.default)(function(t,i){return de(a,void 0,void 0,function(){var n;return he(this,function(e){switch(e.label){case 0:return[4,ee.default.addHash(t.body)];case 1:return n=e.sent(),i.status(200).json({form:n}),[2]}})})}),this.generateForm=(0,_e.default)(function(t,i){return de(a,void 0,void 0,function(){var n,e;return he(this,function(o){switch(o.label){case 0:return[4,ee.default.findById(t.formId)];case 1:return n=o.sent(),[4,wn.default.findByIdWithResults(n.form_scheme_id,n.id)];case 2:return e=o.sent(),i.status(200).json({form:n,form_scheme:e}),[2]}})})}),this.invalidateLink=(0,_e.default)(function(t,i){return de(a,void 0,void 0,function(){var n;return he(this,function(e){switch(e.label){case 0:return n=t.body.id,[4,ee.default.removeHash(n)];case 1:return e.sent(),i.status(200).json({message:"the link is invalid now"}),[2]}})})}),this.setExpireTime=(0,_e.default)(function(t,i){return de(a,void 0,void 0,function(){var n,e;return he(this,function(o){switch(o.label){case 0:return n=t.decodedToken,[4,ee.default.setExpireTime({id:t.body.id,expire_hash_time:t.body.expire_hash_time,user_id:n?.id})];case 1:return e=o.sent(),i.status(200).json({form:e}),[2]}})})}),this.findById=(0,_e.default)(function(t,i){return de(a,void 0,void 0,function(){var n,e,o,s;return he(this,function(c){switch(c.label){case 0:return n=t.params.id,[4,ee.default.findById(n,{id:(s=t.decodedToken)===null||s===void 0?void 0:s.id})];case 1:return e=c.sent(),[4,wn.default.findByIdWithResults(e.form_scheme_id,e.id)];case 2:return o=c.sent(),i.status(200).json({form:e,form_scheme:o}),[2]}})})}),this.getUserForm=(0,_e.default)(function(t,i){return de(a,void 0,void 0,function(){var n,e,o;return he(this,function(s){switch(s.label){case 0:return[4,ee.default.findByFormSchemeId(fs.default.USER_FORM_ID,{id:(o=t.decodedToken)===null||o===void 0?void 0:o.id})];case 1:return n=s.sent(),[4,wn.default.findByIdWithResults(n.form_scheme_id,n.id)];case 2:return e=s.sent(),i.status(200).json({user_form:n,form_scheme:e}),[2]}})})}),this.verifyForm=(0,_e.default)(function(t,i){return de(a,void 0,void 0,function(){var n,e,o,s;return he(this,function(c){switch(c.label){case 0:return n=t.body.id,[4,ee.default.verifyForm(n,{id:(o=t.decodedToken)===null||o===void 0?void 0:o.id})];case 1:return c.sent(),[4,ee.default.updateDone(n,!0,{id:(s=t.decodedToken)===null||s===void 0?void 0:s.id})];case 2:return e=c.sent(),i.status(200).json({message:"the form is done!",form:e}),[2]}})})})}return u}(),hs=new ds;z.default=hs});var Ji=d(ye=>{"use strict";var _s=ye&&ye.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},ys=ye&&ye.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},Xt=ye&&ye.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(ye,"__esModule",{value:!0});var Gi=Xt(y()),Wi=Xt(ot()),vs=Xt(E()),ws=Cr(),Vi=Xt(h()),ms=(0,vs.default)(function(u,a,t){return _s(void 0,void 0,void 0,function(){var i,n,e;return ys(this,function(o){switch(o.label){case 0:return i=u.params.hash,[4,Wi.default.findByHash(i)];case 1:if(n=o.sent(),e=(0,ws.verifyHmacHash)({form_id:n?.id},i),!e)throw new Vi.default(Gi.default.HASH_IS_NOT_VALID);return n.expire_hash_time&&n.expire_hash_time<new Date?[4,Wi.default.removeHash(n.id)]:[3,3];case 2:throw o.sent(),new Vi.default(Gi.default.HASH_IS_EXPIRED);case 3:return u.formId=n?.id,t(),[2]}})})});ye.default=ms});var Xi=d(_t=>{"use strict";var Yt=_t&&_t.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(_t,"__esModule",{value:!0});var bs=require("express"),ze=Yt(Pe()),ve=Yt(Li()),Xe=require("express-validator"),xi=Yt(Rr()),zt=Ge(),ps=Yt(Ji()),te=(0,bs.Router)();te.route("/").get(ze.default,(0,xi.default)([zt.Roles.admin,zt.Roles.sales]),ve.default.findAll);te.route("/user-form").get(ze.default,ve.default.getUserForm);te.route("/:id").get(ze.default,ve.default.findById);te.route("/").post(ze.default,(0,xi.default)([zt.Roles.admin,zt.Roles.sales]),[(0,Xe.body)("form_scheme_id").isNumeric().withMessage("form_scheme_id is required")],ve.default.save);te.route("/expire-time").post(ze.default,[(0,Xe.body)("expire_hash_time").isNumeric().withMessage("expire_hash_time is required"),(0,Xe.body)("id").isNumeric().withMessage("id is required")],ve.default.setExpireTime);te.route("/generate-link").post([(0,Xe.body)("id").isNumeric().withMessage("id is required")],ve.default.generateLink);te.route("/generate-form/:hash").get(ps.default,ve.default.generateForm);te.route("/invalidate-link").post([(0,Xe.body)("id").isNumeric().withMessage("id is required")],ve.default.invalidateLink);te.route("/verify-form").post(ze.default,[(0,Xe.body)("id").isNumeric().withMessage("id is required")],ve.default.verifyForm);_t.default=te});var Zi=d(Ye=>{"use strict";var gs=Ye&&Ye.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(Ye,"__esModule",{value:!0});Ye.uploadFile=void 0;var Yi=gs(require("multer")),Es=Yi.default.diskStorage({destination:function(u,a,t){t(null,"multimedia/")},filename:function(u,a,t){var i=["video/mp4"];if(i.includes(a.mimetype)){t(null,crypto.randomUUID()+".mp4");return}t(null,crypto.randomUUID()+".jpg")}}),zi=3*1024*1024;Ye.uploadFile=(0,Yi.default)({storage:Es,fileFilter:function(u,a,t){var i=["image/jpeg","image/jpg","image/png"],n=["video/mp4"],e=u.headers["content-length"];if(parseInt(e)>zi){t(null,!1);return}if(n.includes(a.mimetype)){t(null,!0);return}if(i.includes(a.mimetype)){t(null,!0);return}t(null,!1)},limits:{fieldSize:zi}})});var mn=d(Y=>{"use strict";var Os=Y&&Y.__extends||function(){var u=function(a,t){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(i[e]=n[e])},u(a,t)};return function(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");u(a,t);function i(){this.constructor=a}a.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Ki=Y&&Y.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},Qi=Y&&Y.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},Ss=Y&&Y.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(Y,"__esModule",{value:!0});var Ts=Ss(ie()),Rs=function(u){Os(a,u);function a(){return u!==null&&u.apply(this,arguments)||this}return a.prototype.deleteByHash=function(t){return Ki(this,void 0,void 0,function(){return Qi(this,function(i){throw new Error("method not implemented")})})},a.prototype.findByHash=function(t){return Ki(this,void 0,void 0,function(){return Qi(this,function(i){throw new Error("method not implemented")})})},a}(Ts.default);Y.default=Rs});var eu=d(Z=>{"use strict";var qs=Z&&Z.__extends||function(){var u=function(a,t){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(i[e]=n[e])},u(a,t)};return function(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");u(a,t);function i(){this.constructor=a}a.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Zt=Z&&Z.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},Kt=Z&&Z.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},$i=Z&&Z.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(Z,"__esModule",{value:!0});var Qt=$i(b()),ks=$i(mn()),Ds=function(u){qs(a,u);function a(){return u!==null&&u.apply(this,arguments)||this}return a.prototype.save=function(t){return Zt(this,void 0,void 0,function(){var i;return Kt(this,function(n){switch(n.label){case 0:return[4,Qt.default.query("INSERT INTO multimedia (name, hash, users_id) VALUES (?, ?, ?)",[t.name,t.hash,t.user_id])];case 1:return i=n.sent()[0],[2,{id:i.insertId,hash:t.hash,name:t.name,user_id:t.user_id}]}})})},a.prototype.deleteById=function(t){return Zt(this,void 0,void 0,function(){var i;return Kt(this,function(n){switch(n.label){case 0:return[4,Qt.default.query("DELETE FROM multimedia WHERE id = ?",[t])];case 1:return i=n.sent()[0],[2,{id:t}]}})})},a.prototype.deleteByHash=function(t){return Zt(this,void 0,void 0,function(){var i;return Kt(this,function(n){switch(n.label){case 0:return[4,Qt.default.query("DELETE FROM multimedia WHERE hash = ?",[t])];case 1:return i=n.sent()[0],i.affectedRows===0?[2,void 0]:[2,{hash:t}]}})})},a.prototype.findByHash=function(t){return Zt(this,void 0,void 0,function(){var i;return Kt(this,function(n){switch(n.label){case 0:return[4,Qt.default.query("SELECT * FROM multimedia WHERE hash = ?",[t])];case 1:return i=n.sent()[0][0],[2,i]}})})},a}(ks.default);Z.default=Ds});var tu=d(K=>{"use strict";var Ms=K&&K.__extends||function(){var u=function(a,t){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(i[e]=n[e])},u(a,t)};return function(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");u(a,t);function i(){this.constructor=a}a.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),$t=K&&K.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},er=K&&K.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},yt=K&&K.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(K,"__esModule",{value:!0});var bn=yt(y()),As=yt(mn()),Is=yt(eu()),pn=yt(h()),js=yt(require("fs/promises")),Fs=function(u){Ms(a,u);function a(t){var i=u.call(this)||this;return i.multimediaRepository=t,i}return a.prototype.save=function(t){return $t(this,void 0,void 0,function(){return er(this,function(i){return[2,this.multimediaRepository.save(t)]})})},a.prototype.deleteById=function(t){return $t(this,void 0,void 0,function(){return er(this,function(i){return[2,this.multimediaRepository.deleteById(t)]})})},a.prototype.deleteByHash=function(t){return $t(this,void 0,void 0,function(){var i;return er(this,function(n){switch(n.label){case 0:return[4,this.multimediaRepository.deleteByHash(t)];case 1:if(i=n.sent(),!i)throw new pn.default(bn.default.FILE_NOT_FOUND);return[4,js.default.unlink("multimedia/".concat(t)).catch(function(){throw new pn.default(bn.default.FILE_NOT_FOUND)})];case 2:return n.sent(),[2,i]}})})},a.prototype.findByHash=function(t){return $t(this,void 0,void 0,function(){var i;return er(this,function(n){switch(n.label){case 0:return[4,this.multimediaRepository.findByHash(t)];case 1:if(i=n.sent(),!i)throw new pn.default(bn.default.FILE_NOT_FOUND);return[2,i]}})})},a}(As.default),Ns=new Fs(new Is.default);K.default=Ns});var ou=d(we=>{"use strict";var ru=we&&we.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},nu=we&&we.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},tr=we&&we.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(we,"__esModule",{value:!0});var iu=tr(y()),gn=tr(tu()),uu=tr(E()),au=tr(h()),Cs=function(){function u(){var a=this;this.save=(0,uu.default)(function(t,i){return ru(a,void 0,void 0,function(){var n,e,o;return nu(this,function(s){switch(s.label){case 0:if(n=t.body.name,!t.file)throw new au.default(iu.default.FILE_FORMAT_NOT_ALLOWED);return[4,gn.default.save({name:n,user_id:(o=t.decodedToken)===null||o===void 0?void 0:o.id,hash:t.file.filename})];case 1:return e=s.sent(),i.status(200).json({message:"the file was submitted succesfully!",media:e}),[2]}})})}),this.deleteByHash=(0,uu.default)(function(t,i){return ru(a,void 0,void 0,function(){var n,e,o;return nu(this,function(s){switch(s.label){case 0:return n=t.params.hash,console.log(n),[4,gn.default.findByHash(n)];case 1:if(e=s.sent(),e.user_id!==((o=t.decodedToken)===null||o===void 0?void 0:o.id))throw new au.default(iu.default.FILE_NOT_FOUND);return[4,gn.default.deleteByHash(n)];case 2:return s.sent(),i.status(200).json({message:"file deleted successfully"}),[2]}})})})}return u}(),Bs=new Cs;we.default=Bs});var fu=d(vt=>{"use strict";var En=vt&&vt.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(vt,"__esModule",{value:!0});var lu=En(require("express")),Hs=Zi(),su=En(ou()),Us=require("express-validator"),cu=En(Pe()),rr=lu.default.Router();rr.use("/",lu.default.static("multimedia"));rr.route("/").post(cu.default,Hs.uploadFile.single("media"),[(0,Us.body)("name").isString().withMessage("name is required")],su.default.save);rr.route("/:hash").delete(cu.default,su.default.deleteByHash);vt.default=rr});var wu=d(me=>{"use strict";var du=me&&me.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},hu=me&&me.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},vu=me&&me.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(me,"__esModule",{value:!0});var _u=vu(Ft()),yu=vu(E()),Ps=function(){function u(){var a=this;this.updateResult=(0,yu.default)(function(t,i){return du(a,void 0,void 0,function(){var n;return hu(this,function(e){switch(e.label){case 0:return[4,_u.default.updateResult(t.body)];case 1:return n=e.sent(),i.status(200).json({message:"field updated successfully",field:n}),[2]}})})}),this.getAllFieldsOfForm=(0,yu.default)(function(t,i){return du(a,void 0,void 0,function(){var n;return hu(this,function(e){switch(e.label){case 0:return[4,_u.default.findAllBySchemeId(2,{id:1})];case 1:return n=e.sent(),i.status(200).json({fields:n}),[2]}})})})}return u}(),Ls=new Ps;me.default=Ls});var pu=d(wt=>{"use strict";var Gs=wt&&wt.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(wt,"__esModule",{value:!0});var Ws=require("express"),bu=Gs(wu()),mu=require("express-validator"),On=(0,Ws.Router)();On.route("/").patch([(0,mu.body)("id").isNumeric().withMessage("id is required"),(0,mu.body)("metadata").custom(function(u){return u.result?u.result:!0})],bu.default.updateResult);On.route("/all").get(bu.default.getAllFieldsOfForm);wt.default=On});var gu=d(mt=>{"use strict";var p=mt&&mt.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(mt,"__esModule",{value:!0});var Sn=p(require("express")),Vs=p(require("path")),Js=p(require("cookie-parser")),xs=p(require("cors")),Xs=p(Dn()),Fe=p(De()),zs=p(Ln()),Ys=p(qi()),Zs=p(Ai()),Ks=p(Ui()),Qs=p(Xi()),$s=p(fu()),ec=p(pu()),w=(0,Sn.default)();w.use(Sn.default.json());w.use((0,Js.default)());w.use((0,xs.default)({origin:["http://localhost:4000","http://localhost:5173"],credentials:!0}));w.get("/health",function(u,a){a.status(200).json({message:"Success!"})});w.use("/",Sn.default.static(Vs.default.resolve(__dirname,"static","dist")));w.use("".concat(Fe.default.API_PREFIX,"/multimedia"),$s.default);w.use("".concat(Fe.default.API_PREFIX,"/users"),zs.default);w.use("".concat(Fe.default.API_PREFIX,"/"),Ys.default);w.use("".concat(Fe.default.API_PREFIX,"/form-schemes"),Ks.default);w.use("".concat(Fe.default.API_PREFIX,"/forms"),Qs.default);w.use("".concat(Fe.default.API_PREFIX,"/fields"),ec.default);w.use("".concat(Fe.default.API_PREFIX,"/results"),Zs.default);w.use("*",function(u,a){a.status(404).json({message:"route not found"})});w.use(Xs.default);mt.default=w});var Su=d(be=>{"use strict";var tc=be&&be.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},rc=be&&be.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},Tn=be&&be.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(be,"__esModule",{value:!0});var Eu=Tn(require("fs/promises")),Ou=Tn(b()),nc=Tn(require("path")),ic=function(){return tc(void 0,void 0,void 0,function(){var u,a,t,i,n;return rc(this,function(e){switch(e.label){case 0:return[4,Eu.default.readdir(__dirname)];case 1:return u=e.sent(),[4,Ou.default.query("SET SESSION time_zone = '+00:00'")];case 2:e.sent(),a=0,t=u,e.label=3;case 3:return a<t.length?(i=t[a],i.match(/ts|js/)?[3,7]:[4,Eu.default.readFile(nc.default.resolve(__dirname,i),{encoding:"utf-8"})]):[3,7];case 4:return n=e.sent(),[4,Ou.default.query(n).catch(function(o){console.log(o)})];case 5:e.sent(),e.label=6;case 6:return a++,[3,3];case 7:return[2]}})})};be.default=ic});var Tu=d(pe=>{"use strict";var uc=pe&&pe.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},ac=pe&&pe.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},oc=pe&&pe.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(pe,"__esModule",{value:!0});var nr=oc(b()),lc=function(){return uc(void 0,void 0,void 0,function(){return ac(this,function(u){switch(u.label){case 0:return[4,nr.default.query('INSERT INTO form_scheme (label, id) VALUES ("Formulario Ola", 1)')];case 1:return u.sent(),[4,nr.default.query('INSERT INTO form_group (label, form_scheme_id) VALUES ("Informaci\xF3n referencial", 1)')];case 2:return u.sent(),[4,nr.default.query(`INSERT INTO field (label, component, form_group_id, metadata)
     VALUES ("Ciudad", "input", 1,  '{"type": "text"}')`)];case 3:return u.sent(),[4,nr.default.query(`INSERT INTO field (label, component, form_group_id, metadata)
     VALUES ("Fecha", "input", 1,  '{"type": "date"}')`)];case 4:return u.sent(),[2]}})})};pe.default=lc});var Du=d(_=>{"use strict";var ir=_&&_.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},bt=_&&_.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},sc=_&&_.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(_,"__esModule",{value:!0});_.createFormSchemeJson=_.createFields=_.createFormGroup=_.createFormScheme=void 0;var Rn=sc(b());function Ru(u){return ir(this,void 0,void 0,function(){return bt(this,function(a){switch(a.label){case 0:return[4,Rn.default.query("INSERT INTO form_scheme (id, label) VALUES (?, ?)",[u.id,u.label])];case 1:return a.sent(),[2,u]}})})}_.createFormScheme=Ru;function qu(u){return ir(this,void 0,void 0,function(){var a;return bt(this,function(t){switch(t.label){case 0:return[4,Rn.default.query("INSERT INTO form_group ( label, form_scheme_id) VALUES (?, ?)",[u.label,u.form_scheme_id])];case 1:return a=t.sent()[0],[2,{id:a.insertId,label:u.label,fields:u.fields}]}})})}_.createFormGroup=qu;function ku(u){return ir(this,void 0,void 0,function(){var a;return bt(this,function(t){switch(t.label){case 0:return[4,Rn.default.query("INSERT INTO field (label, component, metadata, form_group_id) VALUES (?, ?, ?, ?)",[u.label,u.component,JSON.stringify(u.metadata),u.form_group_id])];case 1:return a=t.sent()[0],[2]}})})}_.createFields=ku;function cc(u){return ir(this,void 0,void 0,function(){var a,t,i,n,e,o;return bt(this,function(s){switch(s.label){case 0:return[4,Ru({id:u.id,label:u.label})];case 1:return s.sent(),a=u.form_groups.map(function(c){return qu({label:c.label,form_scheme_id:u.id,fields:c.fields})}),[4,Promise.all(a)];case 2:t=s.sent(),i=function(c){var r;return bt(this,function(l){switch(l.label){case 0:return r=c.fields.map(function(f){return ku({label:f.label,component:f.component,form_group_id:c.id,metadata:f.metadata})}),[4,Promise.all(r)];case 1:return l.sent(),[2]}})},n=0,e=t,s.label=3;case 3:return n<e.length?(o=e[n],[5,i(o)]):[3,6];case 4:s.sent(),s.label=5;case 5:return n++,[3,3];case 6:return[2]}})})}_.createFormSchemeJson=cc});var Mu=d((Yf,fc)=>{fc.exports={id:2,label:"Formulario de usuario",form_groups:[{label:"Inicio",fields:[{label:"Cargo solicitado",component:"select",metadata:{type:"string",options:[{value:"design",label:"Dise\xF1o"}]}},{label:"Lugar",component:"input",metadata:{type:"text"}},{label:"Fecha",component:"input",metadata:{type:"date"}}]},{label:"Mis datos",fields:[{label:"Nombres y Apellidos",component:"input",metadata:{type:"text"}}]},{label:"Estado Civil",fields:[{label:"Estado Civil",component:"select",metadata:{type:"text",options:[{value:"single",label:"soltero"},{value:"married",label:"casado"}]}}]},{label:"Direcci\xF3n",fields:[{label:"Direcci\xF3n Domicilio",component:"input",metadata:{type:"string"}},{label:"Ciudad",component:"input",metadata:{type:"string"}},{label:"Parroquia",component:"input",metadata:{type:"string"}},{label:"Tel\xE9fono",component:"input",metadata:{type:"string"}}]},{label:"Tallas",fields:[{label:"Calzado",component:"input",metadata:{type:"number"}}]},{label:"Banco o cooperativa",fields:[{label:"Nombre de banco o cooperativa",component:"input",metadata:{type:"string"}},{label:"N\xFAmero de cuenta",component:"input",metadata:{type:"string"}}]},{label:"Fisiol\xF3gico",fields:[{label:"Tipo de sangre",component:"select",metadata:{type:"string",options:[{value:"A+",label:"A+"},{value:"A-",label:"A-"},{value:"B+",label:"B+"},{value:"B-",label:"B-"},{value:"AB+",label:"AB+"},{value:"AB-",label:"AB-"},{value:"O+",label:"O+"},{value:"O-",label:"O-"}]}},{label:"Presenta alg\xFAn tipo de discapacidad",component:"select",metadata:{options:[{value:1,label:"S\xED"},{value:0,label:"No"}]}},{label:"Carnet Conadis",component:"input",metadata:{type:"string"}}]},{label:"Estado Civil informaci\xF3n adicional",fields:[{label:"Nombre del c\xF3nyuge",component:"input",metadata:{type:"string"}},{label:"Empresa y cargo",component:"input",metadata:{type:"string"}},{label:"Trabaja",component:"select",metadata:{type:"boolean",options:[{value:1,label:"S\xED"},{value:0,label:"No"}]}}]},{label:"Familia",fields:[{label:"Cargas familiares",component:"select",metadata:{type:"boolean",options:[{value:1,label:"S\xED"},{value:0,label:"No"}]}},{label:"N\xFAmero de cargas familiares",component:"input",metadata:{type:"number"}},{label:"En caso de emergencia llamar al n\xFAmero",component:"input",metadata:{type:"string"}},{label:"Ha trabajado anteriormente en alguna empresa de",component:"input",metadata:{type:"string"}}]},{label:"Estudios",fields:[{label:"Instituci\xF3n",component:"input",metadata:{type:"string"}},{label:"Ciudad",component:"input",metadata:{type:"string"}},{label:"Grado o curso aprobado",component:"input",metadata:{type:"string"}},{label:"T\xEDtulo/Profesi\xF3n",component:"input",metadata:{type:"string"}}]},{label:"Empresas anteriores (\xBFen qu\xE9 empresas ha trabajado o realizado su pasant\xEDas antes?)",fields:[{label:"Liste las empresas anteriores en las que ha trabajado",component:"input",metadata:{type:"list/string"}}]},{label:"Terminos y condiciones",fields:[{label:"Declaro que la inform\xE1ci\xF3n proporcionada corresponde a la verdad y asumo las consecuencias legales si se demuestra lo contrario",component:"select",metadata:{type:"boolean/check"}}]}]}});var Au=d(ge=>{"use strict";var dc=ge&&ge.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},hc=ge&&ge.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},_c=ge&&ge.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(ge,"__esModule",{value:!0});var yc=Du(),vc=_c(Mu()),wc=function(){return dc(void 0,void 0,void 0,function(){return hc(this,function(u){switch(u.label){case 0:return[4,(0,yc.createFormSchemeJson)(vc.default)];case 1:return u.sent(),[2]}})})};ge.default=wc});var ju=d(Ee=>{"use strict";var mc=Ee&&Ee.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},bc=Ee&&Ee.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},ur=Ee&&Ee.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(Ee,"__esModule",{value:!0});var pc=ur(Se()),Iu=Ge(),gc=ur(jr()),Ec=ur(Tu()),Oc=ur(Au()),Sc=function(){return mc(void 0,void 0,void 0,function(){var u;return bc(this,function(a){switch(a.label){case 0:return[4,(0,gc.default)("1234")];case 1:return u=a.sent(),[4,pc.default.saveAdmin({email:"admin@email.com",fullname:"admin",area:Iu.UserArea.admin,password:u,role:Iu.Roles.admin}).catch(function(){console.log("duplicated admin user")}).finally(function(){console.log("user admin created")})];case 2:return a.sent(),[4,(0,Ec.default)().catch(function(t){console.log(t),console.log("the first form is already created")})];case 3:return a.sent(),[4,(0,Oc.default)().catch(function(t){console.log(t),console.log("user form scheme is already created")})];case 4:return a.sent(),[2]}})})};Ee.default=Sc});var Fu=d(qn=>{"use strict";Object.defineProperty(qn,"__esModule",{value:!0});var Tc=function(u){return new Promise(function(a){return setTimeout(a,u*1e3)})};qn.default=Tc});var Cu=d(Oe=>{"use strict";var Rc=Oe&&Oe.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},qc=Oe&&Oe.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},Nu=Oe&&Oe.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(Oe,"__esModule",{value:!0});var kc=Nu(b()),Dc=Nu(Fu()),Mc=function(){return Rc(void 0,void 0,void 0,function(){var u,a;return qc(this,function(t){switch(t.label){case 0:u=!0,t.label=1;case 1:if(!u)return[3,7];t.label=2;case 2:return t.trys.push([2,4,,5]),[4,kc.default.query("SELECT 1")];case 3:return t.sent(),u=!1,console.log("connection stablished!"),[3,5];case 4:return a=t.sent(),console.log("testing connection..."),[3,5];case 5:return[4,(0,Dc.default)(.5)];case 6:return t.sent(),[3,1];case 7:return[2]}})})};Oe.default=Mc});var Ac=exports&&exports.__awaiter||function(u,a,t,i){function n(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function s(l){try{r(i.next(l))}catch(f){o(f)}}function c(l){try{r(i.throw(l))}catch(f){o(f)}}function r(l){l.done?e(l.value):n(l.value).then(s,c)}r((i=i.apply(u,a||[])).next())})},Ic=exports&&exports.__generator||function(u,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,n,e,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(r){return function(l){return c([r,l])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(t=0)),t;)try{if(i=1,n&&(e=r[0]&2?n.return:r[0]?n.throw||((e=n.return)&&e.call(n),0):n.next)&&!(e=e.call(n,r[1])).done)return e;switch(n=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,n=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=a.call(u,t)}catch(l){r=[6,l],n=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},pt=exports&&exports.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(exports,"__esModule",{value:!0});var jc=pt(gu()),Bu=pt(De()),Fc=pt(Su()),Nc=pt(ju()),Cc=pt(Cu());(0,Cc.default)().then(function(){return Ac(void 0,void 0,void 0,function(){return Ic(this,function(u){switch(u.label){case 0:return[4,(0,Fc.default)().catch(function(a){console.log(a)})];case 1:return u.sent(),console.log("database initialized!"),[4,(0,Nc.default)().catch(function(a){console.log("///////////////////////////////",a)})];case 2:return u.sent(),jc.default.listen(Bu.default.PORT,function(){console.log("the server has started in port ".concat(Bu.default.PORT))}),[2]}})})});
